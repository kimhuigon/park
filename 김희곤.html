<body> 수정수정
    <div id="map" style="width:500px;height:400px; margin-left: 50%; transform: translateX(-50%); margin-top: 100px;">
    </div>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=41ce8b9519ec9b48b457759b6dff0a54"></script>
    <script>
      const imageSrc = "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png";
  
      get(); // 호이스팅 hoisting
  
      async function get() {
        const url = 'parkdata.json';
        const res = await fetch(url);
        const data = await res.json();
        const list = data.records;
  
        // 현재 위치 가져오기
        navigator.geolocation.getCurrentPosition((pos) => {
          const currentLat = pos.coords.latitude;
          const currentLng = pos.coords.longitude;
          const container = document.getElementById('map');
          const options = {
            center: new kakao.maps.LatLng(currentLat, currentLng),
            level: 3
          };
  
          const map = new kakao.maps.Map(container, options);
  
          // 현재 위치에 마커 추가
          const markerPosition = new kakao.maps.LatLng(currentLat, currentLng);
          const marker = new kakao.maps.Marker({
            position: markerPosition
          });
          marker.setMap(map);
  
          // 현재 위치에 인포윈도우 추가
          const currentLocationInfoWindow = new kakao.maps.InfoWindow({
            content: `<div style="padding:5px;">내 위치</div>`
          });
          currentLocationInfoWindow.open(map, marker);
  
          // 공원의 커스텀 마커 이미지 설정
          const markerImage = new kakao.maps.MarkerImage(imageSrc, new kakao.maps.Size(24, 35));
  
          // 각 공원의 거리 계산
          const parksWithDistance = list.map((v) => {
            const parkLat = v.위도;
            const parkLng = v.경도;
            const distance = getDistance(currentLat, currentLng, parkLat, parkLng);
            return { ...v, distance };
          });
  
          // 거리가 가까운 순으로 정렬
          parksWithDistance.sort((a, b) => a.distance - b.distance);
  
          // 가장 가까운 5개의 공원 선택
          const closestParks = parksWithDistance.slice(0, 5);
  
          // 가까운 5개 공원 마커 추가
          closestParks.forEach((v) => {
            const name = v.공원명;
            const lat = v.위도;
            const lng = v.경도;
            const markerPosition = new kakao.maps.LatLng(lat, lng);
  
            const marker = new kakao.maps.Marker({
              position: markerPosition,
              image: markerImage
            });
            marker.setMap(map);
  
            // 마커에 인포윈도우 추가
            const infowindow = new kakao.maps.InfoWindow({
              content: `<div style="padding:5px;">${name}</div>`
            });
  
            kakao.maps.event.addListener(marker, 'mouseover', () => {
              infowindow.open(map, marker);
            });
  
            kakao.maps.event.addListener(marker, 'mouseout', () => {
              infowindow.close();
            });
          });
        });
      }
  
      function getDistance(lat1, lng1, lat2, lng2) {
        const R = 6371; // 지구 반지름 (단위: km)
        const dLat = (lat2 - lat1) * Math.PI / 180;
        const dLng = (lng2 - lng1) * Math.PI / 180;
        const a = 
          0.5 - Math.cos(dLat)/2 + 
          Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
          (1 - Math.cos(dLng)) / 2;
  
        return R * 2 * Math.asin(Math.sqrt(a));
      }
    </script>
  </body>
  